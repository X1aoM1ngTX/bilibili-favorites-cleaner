<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>哔哩哔哩收藏夹清理工具</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1 class="title">哔哩哔哩收藏夹清理工具</h1>
            <p class="subtitle">一键清理所有收藏夹中的失效内容</p>
        </header>

        <main class="main">
            <!-- 配置状态显示 -->
            <section class="config-status" id="configStatus">
                <div class="status-card">
                    <h3>配置状态</h3>
                    <div class="status-indicator" id="statusIndicator">
                        <span class="status-dot" id="statusDot"></span>
                        <span class="status-text" id="statusText">检查中...</span>
                    </div>
                    <div class="user-info" id="userInfo" style="display: none;">
                        <span>用户ID: <strong id="userId"></strong></span>
                    </div>
                </div>
            </section>

            <!-- 选项卡导航 -->
            <nav class="tab-nav">
                <button class="tab-btn active" data-tab="login">登录配置</button>
                <button class="tab-btn" data-tab="clean">清理收藏夹</button>
            </nav>

            <!-- 登录配置面板 -->
            <section class="tab-panel active" id="loginPanel">
                <div class="card">
                    <h2>嵌入式登录</h2>
                    <p>通过iframe模式安全登录，登录成功后自动保存配置</p>
                    
                    <div id="iframeContainer" class="iframe-container"></div>
                    <div id="loginStatus" class="status"></div>
                </div>

                <div class="card">
                    <h2>Cookie展示与复制</h2>
                    <p>展示当前登录的Cookie，支持一键复制</p>
                    
                    <div class="cookie-display">
                        <div class="cookie-container">
                            <div class="cookie-header">
                                <span>当前Cookie：</span>
                                <button class="btn btn-small btn-primary" id="copyCookieBtn">
                                    📋 复制Cookie
                                </button>
                            </div>
                            <div class="cookie-content" id="cookieContent">
                                <div class="cookie-placeholder" id="cookiePlaceholder">
                                    请先登录获取Cookie
                                </div>
                                <div class="cookie-text" id="cookieText" style="display: none;">
                                    <pre id="cookieValue"></pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="button-group">
                        <button class="btn btn-secondary" id="refreshCookieBtn">
                            🔄 刷新Cookie
                        </button>
                    </div>

                    <div id="copyStatus" class="status"></div>
                </div>

                <div class="card">
                    <h2>手动配置</h2>
                    <div class="manual-config">
                        <p>如果嵌入式登录不工作，你也可以手动配置Cookie：</p>
                        <button class="btn btn-secondary" id="manualConfigBtn">手动配置Cookie</button>
                        <div class="manual-form" id="manualForm" style="display: none;">
                            <textarea
                                id="manualCookieInput"
                                placeholder="请粘贴完整的Cookie字符串，包含SESSDATA、bili_jct、DedeUserID等字段"
                                rows="6"
                            ></textarea>
                            <button class="btn btn-primary" id="saveCookieBtn">保存Cookie</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 清理收藏夹面板 -->
            <section class="tab-panel" id="cleanPanel">
                <div class="card">
                    <h2>收藏夹列表</h2>
                    <div class="favorites-container" id="favoritesContainer">
                        <div class="loading" id="favoritesLoading">
                            <div class="spinner"></div>
                            <p>正在获取收藏夹列表...</p>
                        </div>
                        <div class="favorites-list" id="favoritesList" style="display: none;">
                            <!-- 动态生成收藏夹列表 -->
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2>批量操作</h2>
                    <div class="batch-operations">
                        <button class="btn btn-primary" id="selectAllBtn">全选</button>
                        <button class="btn btn-secondary" id="deselectAllBtn">取消全选</button>
                        <button class="btn btn-danger" id="cleanSelectedBtn">清理选中的收藏夹</button>
                        <button class="btn btn-warning" id="cleanAllBtn">清理所有收藏夹</button>
                    </div>
                    <div class="progress-container" id="progressContainer" style="display: none;">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <div class="progress-text" id="progressText">准备开始...</div>
                    </div>
                </div>
            </section>
        </main>

        <!-- 消息提示 -->
        <div class="toast" id="toast">
            <div class="toast-content" id="toastContent"></div>
        </div>
    </div>

    <!-- 引入QRCode库 -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <script src="app.js"></script>
</body>
</html>